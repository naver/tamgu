# Πλαίσιο (Frame)

Η κλάση `Frame` χρησιμοποιείται για τον ορισμό πολύπλοκων δομών δεδομένων μαζί με συναρτήσεις. Παρέχει τα εξής χαρακτηριστικά:

- Οι μεταβλητές μέλη μπορούν να δημιουργηθούν εντός του πλαισίου.
- Μπορεί να δηλωθεί μια μέθοδος `_initial`, η οποία θα καλείται αυτόματα για κάθε νέα περίπτωση αυτού του πλαισίου.
- Μπορεί να δηλωθεί ένα υποπλαίσιο εντός του σώματος του πλαισίου, το οποίο κληρονομεί αυτόματα τις μεθόδους και τις μεταβλητές από το ανώτερο πλαίσιο.
- Είναι δυνατή η αναδήλωση μιας συνάρτησης εντός ενός υποπλαισίου.
- Μπορούν επίσης να δηλωθούν ιδιωτικές συναρτήσεις και μεταβλητές εντός ενός πλαισίου.

## Παράδειγμα

```cpp
frame myframe {
    int i = 10; // κάθε νέο πλαίσιο θα δημιουργεί το i με την τιμή 10
    string s = "αρχική";
    
    function display() {
        print("ΣΤΟ MYFRAME: " + s + "\n");
    }
    
    frame mysubframe {
        function display() {
            print("ΣΤΟ MYSUBFRAME: " + s + "\n");
        }
    }
}
```

## Χρήση ενός πλαισίου

Ένα αντικείμενο πλαισίου δηλώνεται με το όνομα του πλαισίου ως τύπος. 

Παράδειγμα:

```cpp
myframe first; // δημιουργεί ένα πρώτο παράδειγμα
mysubframe subfirst; // δημιουργεί ένα παράδειγμα υποπλαισίου

// Μπορούμε να δημιουργήσουμε ένα νέο παράδειγμα
first = myframe; // ισοδύναμο με "new myframe" στη C++ ή τη Java

// Για να εκτελέσουμε μια συνάρτηση του πλαισίου
myframe.display();
```

## Συνάρτηση `_initial`

Μια συνάρτηση δημιουργού μπορεί να συσχετιστεί με ένα πλαίσιο. Αυτή η συνάρτηση καλείται αυτόματα όταν δημιουργείται μια νέα περίπτωση αυτού του πλαισίου.

Παράδειγμα:

```cpp
frame myframe {
    int i = 10; // κάθε νέο πλαίσιο θα δημιουργεί το i με την τιμή 10
    string s = "αρχική";
    
    function _initial(int ij) {
        i = ij;
    }
    
    function display() {
        print("ΣΤΟ MYFRAME: " + s + "\n");
    }
}

// Δημιουργείται μια νέα περίπτωση του myframe
myframe second(10); // οι παράμετροι περνιούνται στη συνάρτηση _initial όπως στη C++
```

## Συνάρτηση `_final`

Η συνάρτηση `_final` καλείται όποτε διαγράφεται ένα αντικείμενο πλαισίου. Συνήθως, ένα αντικείμενο που δηλώνεται σε μια συνάρτηση ή σε ένα βρόχο διαγράφεται όταν αυτή η συνάρτηση ή βρόχος τελειώνει.

Σημαντικά:
- Αυτή η συνάρτηση δεν έχει παραμέτρους.
- Η κλήση σε αυτήν τη συνάρτηση δεν διαγράφει το αντικείμενο.
- Το περιεχόμενο αυτής της συνάρτησης δεν μπορεί να ελεγχθεί για σφάλματα επειδή καλείται από τον καταστροφέα, ανεξάρτητα από τον υπόλοιπο κώδικα.

Παράδειγμα:

```cpp
frame myframe {
    int i = 10; // κάθε νέο πλαίσιο θα δημιουργεί το i με την τιμή 10
    string s = "αρχική";
    
    function _initial(int ij) {
        i = ij;
    }
    
    function _final() {
        print("ΣΤΟ MYFRAME: " + s + "\n");
    }
}

int i = 10;
while (i >= 0) {
    // Δημιουργείται μια νέα περίπτωση του myframe
    // Στο τέλος κάθε επανάληψης, θα κληθεί η συνάρτηση _final
    myframe item(i);
    i--;
}
```

## Σειρά Αρχικοποίησης

Όταν οι στοιχεία δηλώνονται εντός ενός πλαισίου, η κλήση της συνάρτησης `_initial` γίνεται από την κορυφή προς τα κάτω, προς τα παιδιά του. Επιπλέον, εάν ένα στοιχείο εντός ενός πλαισίου F δημιουργείται εντός της συνάρτησης `_initial` αυτού του πλαισίου F, τότε αυτή η δήλωση έχει προτεραιότητα έναντι οποιασδήποτε άλλης δήλωσης.

Παράδειγμα:

```cpp
// Δηλώνουμε δύο πλαίσια
frame within {
    int i;
    
    // Με μια συγκεκριμένη συνάρτηση κατασκευής
    function _initial(int j) {
        i = j * 2;
        println("στο within _initial", i);
    }
}

// Αυτό το πλαίσιο δηλώνει ένα συγκεκριμένο "within" πλαίσιο
frame test {
    int i;
    
    // Σε αυτήν την περίπτωση, δηλώνουμε ένα συγκεκριμένο πλαίσιο, η δήλωση του οποίου εξαρτάται από τη μεταβλητή i
    within w(i);
    
    // Η συνάρτηση _initial για αυτό το πλαίσιο...
    function _initial(int k) {
        i = k;
        println("στο test _initial", k);
    }
}

// Δημιουργούμε ένα παράδειγμα test: t1 με αρχική τιμή 20
test t1(20);
```

## Δημιουργία μέσα στον κατασκευαστή

Είναι δυνατή η δημιουργία ενός στοιχείου πλαισίου είτε με τη δήλωση της αρχικοποίησής του απευθείας στη λίστα πεδίων του πλαισίου είτε μέσα στον ίδιο τον κατασκευαστή. Όταν η κατασκευή του στοιχείου πλαισίου γίνεται στον κατασκευαστή, αρκεί μια απλή δήλωση· οποιαδήποτε άλλη δήλωση θα ήταν περιττή.

Παράδειγμα:

```cpp
// Αυτό το πλαίσιο δηλώνει ένα συγκεκριμένο "within" πλαίσιο
frame test {
    int i;
    
    // Σε αυτήν την περίπτωση, αναβάλλουμε την πραγματική δημιουργία του στοιχείου στον κατασκευαστή: _initial
    within w;
    
    // Η συνάρτηση _initial για αυτό το πλαίσιο...
    function _initial(int k) {
        i = k;
        // Αντικαθιστούμε την προηγούμενη περιγραφή με μια νέα
        // Αυτή η δήλωση υποκαθιστά την προηγούμενη περιγραφή
        w = within(100);
        println("στο test _initial", k);
    }
}

// Δημιουργούμε ένα παράδειγμα test: t1 με αρχική τιμή 20
test t1(20);
```

Σημαντικό:
Εάν απαιτούνται παράμετροι κατασκευής για το "w" και δεν γίνεται καμία δημιουργία αυτού του στοιχείου "w" στον κατασκευαστή, τότε το Tamgu θα επιστρέψει ένα σφάλμα για λανθασμένες παραμέτρους.

## Κοινές Μεταβλητές

Το Tamgu παρέχει έναν απλό τρόπο για τη δήλωση μεταβλητών κλάσης. Μια μεταβλητή κλάσης είναι μια μεταβλητή η οποία η τιμή της κοινής σε όλες τις περιπτώσεις ενός συγκεκριμένου πλαισίου.

Παράδειγμα:

```cpp
frame myframe {
    common int i; // κάθε πλαίσιο θα έχει πρόσβαση στο ίδιο κοινό παράδειγμα αυτής της μεταβλητής
}

myframe t1;
myframe t2;
t1.i = 10;
t2.i = 15;
println(t1.i, t2.i); // εμφάνιση για και τις δύο μεταβλητές: 15 15
```

## Ιδιωτικές Συναρτήσεις και Μέλη

Ορισμένες συναρτήσεις ή μεταβλητές μπορούν να δηλωθούν ως ιδιωτικές σε ένα πλαίσιο. Μια ιδιωτική συνάρτηση ή μια ιδιωτική μεταβλητή μπορεί να προσπελαστεί μόνο από εντός του πλαισίου.

Παράδειγμα:

```cpp
frame myframe {
    int i = 10; // κάθε νέο πλαίσιο θα δημιουργεί το i με την τιμή 10
    
    // ιδιωτική μεταβλητή
    private string s = "αρχική";
    
    function _initial(int ij) {
        i = ij;
    }
    
    // ιδιωτική συνάρτηση
    private function modify(int x) {
        i = x;
        s = "Τροποποιήθηκε με: " + x; // μπορείτε να τροποποιήσετε το "s" εδώ
    }
    
    function display() {
        modify(1000); // μπορείτε να καλέσετε το "modify" εδώ
        print("ΣΤΟ MYFRAME: " + s + "\n");
    }
}

myframe test;

// Μη έγκυρες εντολές για ιδιωτικά μέλη πλαισίου...
test.modify(100); // αυτή η εντολή είναι μη έγκυρη επειδή το "modify" είναι ιδιωτικό
println(test.s); // αυτή η εντολή είναι μη έγκυρη επειδή το "s" είναι ιδιωτικό
```

## Υποπλαίσιο ή Εμπλουτισμός ενός Πλαισίου

Το Tamgu επιτρέπει στον προγραμματιστή να εμπλουτίσει ή να δημιουργήσει ένα υποπλαίσιο ενός υπάρχοντος πλαισίου. Μια περιγραφή πλαισίου μπορεί να υλοποιηθεί σε λίγα βήματα. Για παράδειγμα, μπορείτε να ξεκινήσετε με μια πρώτη περιγραφή και να αποφασίσετε να την εμπλουτίσετε αργότερα στο πρόγραμμα.

### Εμπλουτισμός

```cpp
// Ξεκινάμε με μια περιορισμένη ορισμό ενός πλαισίου...
frame myframe {
    int i = 10; // κάθε νέο πλαίσιο θα δημιουργεί το i με την τιμή 10
}

// Προσθέτουμε κάποιον κώδικα εδώ...

// Στη συνέχεια εμπλουτίζουμε αυτό το πλαίσιο με κάποια νέα πράγματα
// Το μόνο που χρειάζεται είναι να χρησιμοποιήσουμε την ίδια οδηγία πλαισίου όπως παραπάνω, προσθέτοντας κάποια νέα πράγματα
frame myframe {
    function display() {
        println(i);
    }
}
```

### Υποπλαίσια

Ένα υποπλαίσιο είναι ένα πλαίσιο που δηλώνεται εντός ενός άλλου πλαισίου (του γονικού πλαισίου), από το οποίο κληρονομεί τόσο τις μεταβλητές όσο και τις συναρτήσεις. Ένα υποπλαίσιο μπορεί στη συνέχεια να αντικαταστήσει συναρτήσεις από το γονικό πλαίσιο με νέες εκδόσεις και να προσθέσει τις δικές του μεταβλητές.

```cpp
// Εάν θέλουμε να προσθέσουμε υποπλαίσια...
frame myframe {
    // Μπορούμε τώρα να προσθέσουμε το υποπλαίσιο μας...
    frame subframe { ... }
}
```

### Χρήση Άνω Ορισμού: frame::function

Εάν χρειάζεστε να χρησιμοποιήσετε τον ορισμό του γονικού πλαισίου αντί του τρέχοντος νήματος, το Tamgu παρέχει ένα μηχανισμό που είναι πολύ παρόμοιος με άλλες γλώσσες όπως η C++ ή η Java. Το όνομα της συνάρτησης πρέπει να προηγείται από το όνομα του πλαισίου μαζί με "::".

Παράδειγμα:

```cpp
// Κλήση υποπλαισίων...
// Ορίζουμε ένα πλαίσιο δοκιμής, στο οποίο ορίζουμε ένα υποπλαίσιο δοκιμής
frame test {
    int i;
    
    function _initial(int k) {
        i = k;
    }
    
    function display() {
        println("Στο test", i);
    }
    
    frame subtest {
        string x;
        
        function display() {
            println("Στο subtest", i);
            test::display(); // θα καλέσει τον άλλο ορισμό της display από το test
        }
    }
}

// Δημιουργούμε δύο αντικείμενα
test t(1);
subtest st(2);

// Στη συνέχεια καλούμε τις διάφορες μεθόδους
t.display(); // εμφάνιση: "Στο test, 1"
st.display(); // εμφάνιση: "Στο subtest, 2" και "Στο test, 2"
st.test::display(); // εμφάνιση: "Στο test, 2"
```

## Συστηματικές Συναρτήσεις

Οι συστηματικές συναρτήσεις χρησιμοποιούνται για να αντιστοιχίσουν τους διάφορους τελεστές της γλώσσας Tamgu σε μεθόδους πλαισίου.

### Συναρτήσεις Σύγκρισης

Το Tamgu παρέχει επίσης έναν τρόπο να βοηθήσει στον καθορισμό συγκεκριμένων συναρτήσεων σύγκρισης μεταξύ διάφορων στοιχείων πλαισίου. Αυτές οι συναρτήσεις έχουν ένα συγκεκριμένο όνομα, αν και θα ενεργοποιηθούν από τους ακόλουθους τελεστές: `>`, `<`, `==`, `!=`, `<=` και `>=`.

Κάθε συνάρτηση έχει ένα μόνο παράμετρο που συγκρίνεται με το τρέχον στοιχείο.

Παρακάτω παρατίθεται μια λίστα με αυτές τις συναρτήσεις:

1. `equal`: function ==(frame b);
2. `different`: function !=(frame b);
3. `inferior`: function <(frame b);
4. `superior`: function >(frame b);
5. `inferior equal`: function <=(frame b);
6. `superior equal`: function >=(frame b);

Κάθε μία από αυτές τις συναρτήσεις πρέπει να επιστρέφει true ή false ανάλογα με το τεστ που πραγματοποιείται.

Παράδειγμα:

```cpp
// Υλοποίηση του τελεστή σύγκρισης σε ένα πλαίσιο
frame comp {
    int k;
    
    // Υλοποιούμε τον τελεστή ανωτέρου
    function <(other b) {
        if (k < b)
            return true;
        return false;
    }
}

// Δημιουργούμε δύο αντικείμενα
comp one;
comp two;

// το one είναι 10 και το two είναι 20
one.k = 10;
two.k = 20;

// το one είναι ανώτερο από το two και η μέθοδος ανώτερο παραπάνω καλείται
if (one < two)
    println("ΕΝΤΑΞΕΙ");
```

### Συναρτήσεις Αριθμητικών Υπολογισμών

Το Tamgu παρέχει έναν μηχανισμό για την υλοποίηση συγκεκριμένων συναρτήσεων για τους διάφορους αριθμητικούς τελεστές. Αυτές οι συναρτήσεις πρέπει να έχουν δύο τελεστές, εκτός από τους τελεστές `++` και `--`. Πρέπει να επιστρέφουν ένα στοιχείο του ίδιου πλαισίου με τα ορίσματά τους.

1. `plus`: function +(frame a, frame b);
2. `minus`: function -(frame a, frame b);
3. `multiply`: function *(frame a, frame b);
4. `divide`: function /(frame a, frame b);
5. `power`: function ^^(frame a, frame b);
6. `shift left`: function <<(frame a, frame b);
7. `shift right`: function >>(frame a, frame b);
8. `mod`: function %(frame a, frame b);
9. `or`: function |(frame a, frame b);
10. `xor`: function ^(frame a, frame b);
11. `and`: function &(frame a, frame b);
12. `++`: function ++();
13. `--`: function --();

Παράδειγμα:

```cpp
frame test {
    int k;
    
    function ++() {
        k++;
    }
    
    // Είναι σημαντικό να δημιουργήσουμε μια νέα τιμή, η οποία επιστρέφεται από τη συνάρτηση
    function +(test a, test b) {
        test res;
        res.k = a.k + b.k;
        return res;
    }
}

test a, b, c;
c = a + b; // Θα καλέσουμε την υλοποίηση του plus παραπάνω.
```

### Συναρτήσεις Αριθμού και Συμβολοσειράς

Μπορείτε επίσης να ερμηνεύσετε ένα αντικείμενο πλαισίου ως συμβολοσειρά ή αριθμό σε αριθμητική έκφραση, για παράδειγμα. Σε αυτήν την περίπτωση, μπορείτε να υλοποιήσετε συναρτήσεις με το όνομα του τύπου του αντικειμένου πλαισίου που θέλετε η περίπτωση σας να ερμηνευτεί ως.

Παράδειγμα:

```cpp
frame test {
    int k;
    string s;
    
    // Επιστρέφουμε μια περίπτωση "test" ως συμβολοσειρά...
    function string() {
        return s;
    }
    
    // Επιστρέφουμε μια περίπτωση "test" ως δεκαδικό...
    function float() {
        return k;
    }
    
    // Επιστρέφουμε μια περίπτωση "test" ως ακέραιο...
    function int() {
        return k;
    }
}
```

### Διάστημα και Δείκτης

Είναι επίσης δυνατή η χρήση ενός αντικειμένου πλαισίου ως διανύσματος ή χάρτη. Είναι δυνατόν να αποκτήσετε πρόσβαση σε στοιχεία μέσω ενός διαστήματος ή να ορίσετε μια τιμή μέσω ενός δείκτη. Για να χρησιμοποιήσετε ένα αντικείμενο με αυτόν τον τρόπο, ο προγραμματιστής πρέπει να υλοποιήσει την ακόλουθη συνάρτηση:

1. function [](self idx, self value): Αυτή η συνάρτηση εισάγει ένα στοιχείο σε ένα διάνυσμα στη θέση idx.
2. function [](self idx): Αυτή η συνάρτηση επιστρέφει την τιμή στη θέση idx.
3. function [:](self left, self right): Αυτή η συνάρτηση επιστρέφει τις τιμές μεταξύ των θέσεων left και right.

Παράδειγμα:

```cpp
frame myvect {
    vector kj;
    
    // Αυτή η συνάρτηση εισάγει μια τιμή στο διάνυσμα στη θέση idx
    function [](int idx, self value) {
        kj[idx] = value;
    }
    
    // Αυτή η συνάρτηση επιστρέφει την τιμή στη θέση idx
    function [](int idx) {
        return kj[idx];
    }
    
    // Αυτή η συνάρτηση επιστρέφει την τιμή μεταξύ των l και r.
    function [:](int l, int r) {
        return kj[l:r];
    }
}

myvect test;
test[0] = 10; // Καλούμε τη συνάρτηση [](...)
test[1] = 5; // Καλούμε τη συνάρτηση [](...)
// Καλούμε τη συνάρτηση [:](...)
println(test[0], test[1], test[0:]); // Εμφάνιση: 10 5 [10, 5]
```

## Ειδικοί διαχειριστές για τα πλαίσια

Είναι δυνατό να περιοριστούν οι διαχειριστές να δέχονται μόνο έναν συγκεκριμένο τύπο `frame`. Απλά πρέπει να δηλώσετε το διάνυσμα ή το λεξικό ως εξής:

```Java
frame Test {
    int a;
}

vector<Test> v;
map<Test> m;
```

Σημείωση ότι στην περίπτωση ενός λεξικού (map), είναι οι τιμές και όχι οι κλειδιά που είναι τύπου `Test`.

Οποιαδήποτε προσπάθεια προσθήκης μιας τιμής που δεν είναι συμβατή με το πλαίσιο θα οδηγήσει σε σφάλμα εκχώρησης.