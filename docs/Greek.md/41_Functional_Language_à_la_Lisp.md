# Λειτουργική Γλώσσα: à la Lisp

Το Tamgu προσφέρει έναν διερμηνέα Lisp που είναι πολύ κοντά στον αρχικό ορισμό της γλώσσας, με δύο σημαντικές εξαιρέσεις:

1. Μια έκφραση Lisp πρέπει να προηγείται από ένα αντίστροφο κάθετο (\).
2. Η γλώσσα εκθέτει τις βασικές συναρτήσεις και τελεστές της Lisp, αλλά επιτρέπει επίσης τη χρήση προσωπικών οδηγιών Tamgu.

## Μέθοδος

Ο διερμηνέας Lisp εκθέτει επίσης έναν νέο τύπο με το όνομα `lisp`, ο οποίος είναι μια παραλλαγή ενός διανύσματος. Αυτός ο τύπος έχει δύο μεθόδους:

- `eval(συμβολοσειρά)`: επιστρέφει την αξιολόγηση μιας συμβολοσειράς ως εντολή Lisp.
- `load(όνομα αρχείου)`: φορτώνει ένα αρχείο και αξιολογεί το περιεχόμενό του.

Σημείωση: Για αυτές τις δύο οδηγίες, ο διπλός εισαγωγικός και ο αντίστροφος κάθετος είναι περιττοί.

**ΣΗΜΑΝΤΙΚΟ**: Είναι δυνατόν να αποφευχθεί η χρήση της "υπερφόρτωσης" Lisp με διπλά εισαγωγικά και αντίστροφους κάθετους σε ένα αρχείο, εάν τα δύο πρώτα χαρακτήρες σε αυτό το αρχείο είναι: `()`. Αυτοί οι χαρακτήρες ενεργοποιούν την καθαρή κατάσταση Lisp.

## Βασικοί Τελεστές Lisp

Η έκδοση Lisp στο Tamgu εκθέτει τις ακόλουθες συναρτήσεις:

1. `apply`: εφαρμόζει μια συνάρτηση σε μια λίστα ορισμάτων.
2. `and`: χρησιμοποιείται σε λογικές εκφράσεις.
3. `append`: ενώνει λίστες μαζί.
4. `atomp`: ελέγχει εάν ένα στοιχείο είναι άτομο.
5. `body`: επιστρέφει το σώμα μιας συνάρτησης.
6. `block`: επιτρέπει ένα μπλοκ οδηγιών. Η τελευταία οδηγία στο μπλοκ επιστρέφει την τιμή της.
7. `or`: λογική έκφραση.
8. `xor`: λογική έκφραση, μπορεί να έχει μόνο δύο ορίσματα.
9. `break`: διακόπτει από ένα βρόχο.
10. `car`: επιστρέφει το πρώτο στοιχείο μιας λίστας.
11. `cdr`: επιστρέφει το υπόλοιπο της λίστας.
12. `cond`: συνθήκη.
13. `cons`: κατασκευάζει μια λίστα από δύο στοιχεία.
14. `consp`: ελέγχει εάν το στοιχείο είναι λίστα.
15. `defun`: ορίζει μια συνάρτηση.
16. `_dropwhile`: παραλείπει στοιχεία μέχρι να μην ταιριάζει η συνθήκη.
17. `eq`: συγκρίνει δύο άτομα.
18. `eval`: αξιολογεί μια συμβολοσειρά ή μια έκφραση Lisp.
19. `_filter`: εφαρμόζει ένα φίλτρο σε μια λίστα.
20. `_foldl`, `_foldr`: εφαρμόζει μια λειτουργία ή ένα λάμδα σε μια λίστα.
21. `_foldl1`, `_foldr1`: εφαρμόζει μια λειτουργία ή ένα λάμδα σε μια λίστα.
22. `for`: επαναλαμβάνει σε μια λίστα.
23. `if`: ελέγχει μια συνθήκη.
24. `key`: επιστρέφει ή ορίζει μια τιμή σε έναν δοχείο.
25. `keys`: επιστρέφει ένα διάστημα τιμών από ένα δοχείο.
26. `label`: αντιστοιχεί μια έκφραση με μια ετικέτα.
27. `lambda`: συνάρτηση που εφαρμόζεται σε v1, v2.
28. `list`: δημιουργεί μια λίστα από στοιχεία.
29. `_map`: εφαρμόζει μια λειτουργία σε μια λίστα.
30. `negation`: λογική έκφραση, αρνείται το όρισμα.
31. `nullp`: ελέγχει εάν η τιμή είναι κενή.
32. `numberp`: ελέγχει εάν η τιμή είναι αριθμός.
33. `quote`: παραθέτει μια έκφραση.
34. `return`: επιστρέφει μια τιμή από έναν βρόχο.
35. `_scanl`, `_scanr`: εφαρμόζει μια λειτουργία σε μια λίστα.
36. `_scanl1`, `_scanr1`: εφαρμόζει μια λειτουργία σε μια λίστα.
37. `self`: επαναλαμβάνει σε ένα λάμδα.
38. `setq`: δημιουργεί ή τροποποιεί μια μεταβλητή.
39. `_takewhile`: αποθηκεύει στοιχεία μέχρι να μην ταιριάζει η συνθήκη.
40. `while`: επαναλαμβάνει.
41. `zerop`: ελέγχει εάν μια τιμή είναι 0.
42. `_zip`: συνδυάζει λίστες μαζί.
43. `_zipwith`: συνδυάζει λίστες μαζί με ένα ενδιάμεσο λειτουργία ή λάμδα.

## Παραδείγματα

Παρακάτω παρουσιάζονται μερικά παραδείγματα χρήσης του διερμηνέα Lisp του Tamgu:

```lisp
; Ένα παράδειγμα 'apply'
(setq f '+)
(apply f '(1 2 3 4))

; Ένα παράδειγμα 'and'
(and (> i 10) (< i 20))

; Ένα παράδειγμα 'append'
(append '(a b c) '(e f g))

; Ένα παράδειγμα 'block'
(block
  (print 'ok)
  (+ 10 20)
)

; Ένα παράδειγμα 'while'
(while (< i 10)
  (if (== i 5)
    (break)
  )
)

; Παραδείγματα 'car', 'cdr'
(car '(a b c))
(cadr '((a b c d) ef))

; Παράδειγμα 'cond'
(cond
  ((< o 10) (print o))
  ((> o 100) (print o))
)

; Παράδειγμα 'cons'
(cons 'a '(b c))

; Ορισμός συνάρτησης
(defun add (x y) (+ x y))
(add 10 20)

; Παράδειγμα '_filter'
; Ο COMPARATOR είναι είτε μια παραθέση σύγκρισης είτε μια λάμδα
(vector v = [1..10])
(println (_filter '(< 3) v))
(println (_filter (lambda (x) (< x 3)) v))

; Παράδειγμα 'for' Loop
(vector v = [1..10])
(for i v (print i))

; Παράδειγμα 'if'
(if (== i 10)
  (print i)
  (+ i 1)
)

; Παράδειγμα 'key'
(key m "test")

; Παράδειγμα 'lambda'
(int j = ((lambda (x) (+ 1 x)) 2))

; Παράδειγμα 'list'
(list 'a 'b '(c d))

; Παράδειγμα '_map'
(vector v = [1..5])
(println (_map '* v))
(println (_map '( - 1) v))
(println (_map '(1 -) v))
(println (_map (lambda (x) (* x 2)) v))

; Παράδειγμα 'self' σε ένα λάμδα
(p = ((lambda (x) (if (< x 20) (self (+ x x)) x)) 1))

; Παράδειγμα '_dropwhile'
(v = (_dropwhile '(< 10) '(1 2 3 4 10 20 30)))

; Παράδειγμα '_takewhile'
(v = (_takewhile '(< 10) '(1 2 3 4 10 20 30)))

; Παράδειγμα '_foldl'
(int res = (_foldl '+ 10 '(10 20 30)))

; Παράδειγμα '_scanl'
(v = (_scanl 1 (lambda (acc x) (+ acc (* 2 x))) '(10 20 30)))

; Παράδειγμα '_zip'
(v = (_zip '(10 20) '(11 21) '(12 22)))

; Παράδειγμα '_zipwith'
(v = (_zipwith '+ '(10 20) '(11 21) '(12 22)))
(v = (_zipwith (lambda (x y z) (- x z (+ 1 y))) '(10 20) '(11 21) '(12 22)))
```

## Καθαρή Λειτουργική Λειτουργία

Μπορείτε εύκολα να προσθέσετε οδηγίες Lisp στα προγράμματά σας με τον περιορισμό της χρήσης του αντίστροφου κάθετου (\) μπροστά από την έκφραση. Ωστόσο, εάν θέλετε να πειραματιστείτε σε μια κονσόλα, αυτοί οι περιορισμοί μπορεί να δυσκολέψουν το παιχνίδι με τη γλώσσα. Για να αντιμετωπίσετε αυτό, έχουμε εισαγάγει την `lispmode(bool)`, η οποία ενεργοποιεί έναν συγκεκριμένο καθαρό λειτουργικό τρόπο Lisp όπου κανένας από αυτούς τους περιορισμούς δεν είναι απαραίτητος. Για να επιστρέψετε στον κοινό διερμηνέα, πρέπει να γράψετε `(lispmode false)`.

Στην περίπτωση του κελύφους Tamgu στο Linux και το Mac OS, μπορείτε να ενεργοποιήσετε αυτήν τη λειτουργία καλώντας το `tamgu –lisp`. Μέσα στο κελί, μπορείτε επίσης να χρησιμοποιήσετε το `lispmode` για να εναλλάσσεστε μεταξύ των δύο λειτουργικών τρόπων.

Ο τελευταίος τρόπος για να ενεργοποιήσετε έναν καθαρό λειτουργικό τρόπο Lisp είναι να προσθέσετε `()` ως τους δύο πρώτους χαρακτήρες σε ένα αρχείο. Όταν ένα αρχείο περιέχει αυτούς τους δύο χαρακτήρες, ο ευθυγραμμιστής θα μπορεί να θεωρήσει τις παρενθέσεις ως διαχωριστικά εκφράσεων, παρόμοια με αυτό που γίνεται με τις "αγκύλες".

Παράδειγμα:

```lisp
()
(defun test(x) (+ x x))
```